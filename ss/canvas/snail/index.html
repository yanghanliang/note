<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
        canvas {
            background-color: pink;
        }
    </style>
</head>
<body>
    <canvas id="snail"></canvas>
    <script>
        // 创建构造函数
        let Snail = function() {
            this.width = 1000
            this.height = 1000
            this.radius = 30
            this.canvas = document.querySelector('#snail')
            this.ctx = this.canvas.getContext('2d')

            this.init()
        }

        // 初始化
        Snail.prototype.init = function() {
            this.setBoxSize() // 设置盒子大小
            this.arcDrawing() // 动态画圆
        }

        // 设置盒子大小
        Snail.prototype.setBoxSize = function () {
            this.canvas.setAttribute('width', this.width) 
            this.canvas.setAttribute('height', this.height) 
        }

        /**
         *  计算弧度
         *  @param  {number}        angle 角度 可传负值
         *  @return {number}        弧度
         *
         */
        Snail.prototype.getArcValue = function (angle) {
            return Math.abs(angle) * Math.PI / 180
        }

        // 动态画圆
        Snail.prototype.arcDrawing = function (params) {
            let canvasInfo = this.canvas.getBoundingClientRect()
            let circularX = this.width / 2
            let circularY = this.height / 2

            // 设置渐变
            let grd = this.ctx.createLinearGradient(0, 0, circularX, circularY)
            grd.addColorStop(0, "#f54f29")
            grd.addColorStop(0.7, "#43ffe1")
            grd.addColorStop(1, "#ff4343")

            this.ctx.strokeStyle = grd
            this.ctx.lineWidth = this.lineWidth

            let startArc = this.getArcValue(0)
            let temp = 0

            var clearId = setInterval(() => {
                let eAngle = this.getArcValue(temp) // 结束的弧度
                this.ctx.clearRect(0, 0, this.width, this.height) // 在给定的矩形内清除指定的像素
                this.ctx.beginPath() // 开始新的一条路径
                console.log(this.radius, 'this.radius')
                this.ctx.arc(circularX, circularY, temp, startArc, eAngle)
                this.ctx.stroke()

                if (temp >= 360) {
                    clearInterval(clearId)
                }
                temp++
            }, 10)
            
            this.ctx.globalCompositeOperation = 'xor'
        }

        new Snail()
    </script>
</body>
</html>